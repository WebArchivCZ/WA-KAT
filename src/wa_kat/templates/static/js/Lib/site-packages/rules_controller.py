#! /usr/bin/env python
# -*- coding: utf-8 -*-
#
# Interpreter version: python 2.7
#
# Imports =====================================================================
from browser import document


# Functions & classes =========================================================
class RadioDescriptor(object):
    def __init__(self, name, val_type=bool):
        self.name = name
        self.type = val_type

        self.elements = [
            el
            for el in document.get(selector="input[name='%s']" % name)
        ]
        self.values = {self._get_right_type(el.value) for el in self.elements}

    def _get_right_type(self, val):
        if self.type == bool:
            return val.lower() == "true"

        return self.type(val)

    def __get__(self, obj, objtype):
        for el in self.elements:
            if el.checked:
                return self._get_right_type(el.value)

        return None

    def __set__(self, obj, value):
        def _normalize(val):
            return str(val).lower()

        for el in self.elements:
            if _normalize(el.value) == _normalize(value):
                el.checked = True
                return

        raise ValueError(
            "Can't set the `%s` to `%s`." % (str(el), repr(value))
        )


class RulesView(object):
    local_traps_radio = RadioDescriptor("local_traps_radio")
    calendars_radio = RadioDescriptor("calendars_radio")
    youtube_radio = RadioDescriptor("youtube_radio")
